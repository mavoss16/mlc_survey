library(readxl)
library(dplyr)
library(janitor)
library(tidyr)
library(stringr)
library(readr)
data <- read_csv("MLC Congregation Survey_December 3, 2025_14.35.csv")
data <- read_csv("MLC Congregation Survey_December 3, 2025_14.35.csv", skip = 1) |>
slice(-1)
View(data)
data <- read_csv("MLC Congregation Survey_December 3, 2025_14.35.csv", skip = 1) |>
slice(-1) |>
type_convert()
data_names <- data.frame(full_name = names(data))
data_names
class(data_names)
clean_names(c("Test Name"))
?clean_names
data_names <- data.frame(full_name = names(data)) |>
mutate(
clean_name = make_clean_names(full_name)
)
data_names
View(dat_names)
View(data_names)
data <- data |>
clean_names()
View(data)
table(data$how_do_you_feel_about_our_church_s_mission_memorial_lutheran_church_and_student_center_is_people_who_share_god_s_love_and_the_message_of_his_salvation_with_isu_students_internationals_families_singles_and_people_of_all_ages_enabling_them_to_learn_and_grow_by_the_grace_of_jesus_christ_memorial_lutheran_is_a_ministry_of_the_lutheran_church_missouri_synod_lcms)
names(data)
new_names <- c(
"start_date",
"end_date",
"response_type",
"ip_address",
"progress",
"duration_in_seconds",
"finished",
"recorded_date",
"response_id",
"recipient_last_name",
"recipient_first_name",
"recipient_email",
"external_data_reference",
"location_latitude",
"location_longitude",
"distribution_channel",
"user_language",
"church_mission_feeling",                  # [18]
"church_expectations_choice",              # [19]
"church_expectations_other",               # [20]
"service_attendance",                      # [21]
"spiritually_fed",                         # [22]
"connected_to_community",                  # [23]
"connection_factors_choice",               # [24]
"connection_factors_other",                # [25]
"music_styles_choice",                     # [26]
"music_styles_other",                      # [27]
"youth_program_feedback",                  # [28]
"church_priorities_choice",                # [29]
"church_priorities_other",                 # [30]
"age_range",                               # [31]
"church_association_length",               # [32]
"additional_thoughts"                      # [33]
)
names(data) <- new_names
data_names$new_names <- new_names
library(forcats)
summary(data)
unique(data$church_mission_feeling)
unique(data$spiritually_fed)
unique(data$connected_to_community)
unique(data$age_range)
unique(data$church_association_length)
data <- data |>
mutate(
church_mission_feeling = factor(church_mission_feeling, levels = c("Very dissatisfied", "Dissatisfied", "Neither satisfied nor dissatisfied", "Satisfied", "Very Sattisfied")),
spiritually_fed = factor(spiritually_fed, levels = c("Rarely", "Sometimes", "Usually", "Always")),
connected_to_community = factor(connected_to_community, levels = c("Rarely", "Sometimes", "Usually", "Always")),
age_range = factor(age_range, levels = c("Under 20", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")),
church_association_length = factor(church_association_length, levels = c("Less than 1 year", "1-5 years", "6-10 years", "11-15 years", "16-20 years", "Over 20 years"))
)
data <- data |>
mutate(
church_mission_feeling = factor(church_mission_feeling, levels = c("Very dissatisfied", "Dissatisfied", "Neither satisfied nor dissatisfied", "Satisfied", "Very Sattisfied")),
spiritually_fed = factor(spiritually_fed, levels = c("Rarely", "Sometimes", "Usually", "Always")),
connected_to_community = factor(connected_to_community, levels = c("Rarely", "Sometimes", "Usually", "Always")),
age_range = factor(age_range, levels = c("Under 20", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")),
church_association_length = factor(church_association_length, levels = c("Less than 1 year", "1-5 years", "6-10 years", "11-15 years", "16-20 years", "Over 20 years"))
) |>
select(
-c(response_type, ip_address, progress, finished, starts_with("recipient"), starts_with("location"), distribution_channel)
)
data <- read_csv("MLC Congregation Survey_December 3, 2025_14.35.csv", skip = 1) |>
slice(-1) |>
type_convert()
data_names <- data.frame(full_name = names(data)) |>
mutate(
clean_name = make_clean_names(full_name)
)
data <- data |>
clean_names()
names(data)
new_names <- c(
"start_date",
"end_date",
"response_type",
"ip_address",
"progress",
"duration_in_seconds",
"finished",
"recorded_date",
"response_id",
"recipient_last_name",
"recipient_first_name",
"recipient_email",
"external_data_reference",
"location_latitude",
"location_longitude",
"distribution_channel",
"user_language",
"church_mission_feeling",                  # [18]
"church_expectations_choice",              # [19]
"church_expectations_other",               # [20]
"service_attendance",                      # [21]
"spiritually_fed",                         # [22]
"connected_to_community",                  # [23]
"connection_factors_choice",               # [24]
"connection_factors_other",                # [25]
"music_styles_choice",                     # [26]
"music_styles_other",                      # [27]
"youth_program_feedback",                  # [28]
"church_priorities_choice",                # [29]
"church_priorities_other",                 # [30]
"age_range",                               # [31]
"church_association_length",               # [32]
"additional_thoughts"                      # [33]
)
names(data) <- new_names
data_names$new_names <- new_names
# Create Factors ----------------------------------------------------------
clean <- data |>
mutate(
church_mission_feeling = factor(church_mission_feeling, levels = c("Very dissatisfied", "Dissatisfied", "Neither satisfied nor dissatisfied", "Satisfied", "Very Sattisfied")),
spiritually_fed = factor(spiritually_fed, levels = c("Rarely", "Sometimes", "Usually", "Always")),
connected_to_community = factor(connected_to_community, levels = c("Rarely", "Sometimes", "Usually", "Always")),
age_range = factor(age_range, levels = c("Under 20", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")),
church_association_length = factor(church_association_length, levels = c("Less than 1 year", "1-5 years", "6-10 years", "11-15 years", "16-20 years", "Over 20 years"))
) |>
select(
-c(response_type, ip_address, progress, finished, starts_with("recipient"), starts_with("location"), distribution_channel, external_data_reference)
)
View(clean)
tabyl(data$age_range)
tabyl(data$church_association_length)
data_names <- data_names |>
mutate(
multi_choice = str_detect("_choice"),
open = str_detect("_other|_feedback|additional_thoughts")
)
data_names <- data_names |>
mutate(
multi_choice = str_detect(new_names, "_choice"),
open = str_detect(new_names, "_other|_feedback|additional_thoughts")
)
?select
data <- read_csv("MLC Congregation Survey_December 3, 2025_14.35.csv", skip = 1) |>
slice(-1) |>
type_convert()
data_names <- data.frame(full_name = names(data)) |>
mutate(
clean_name = make_clean_names(full_name)
)
data <- data |>
clean_names()
names(data)
new_names <- c(
"start_date",
"end_date",
"response_type",
"ip_address",
"progress",
"duration_in_seconds",
"finished",
"recorded_date",
"response_id",
"recipient_last_name",
"recipient_first_name",
"recipient_email",
"external_data_reference",
"location_latitude",
"location_longitude",
"distribution_channel",
"user_language",
"church_mission_feeling",                  # [18]
"church_expectations_choice",              # [19]
"church_expectations_other",               # [20]
"service_attendance",                      # [21]
"spiritually_fed",                         # [22]
"connected_to_community",                  # [23]
"connection_factors_choice",               # [24]
"connection_factors_other",                # [25]
"music_styles_choice",                     # [26]
"music_styles_other",                      # [27]
"youth_program_feedback",                  # [28]
"church_priorities_choice",                # [29]
"church_priorities_other",                 # [30]
"age_range",                               # [31]
"church_association_length",               # [32]
"additional_thoughts"                      # [33]
)
names(data) <- new_names
data_names$new_name <- new_names
data_names <- data_names |>
mutate(
multi_choice = str_detect(new_names, "_choice"),
open = str_detect(new_names, "_other|_feedback|additional_thoughts")
)
clean <- data |>
mutate(
church_mission_feeling = factor(church_mission_feeling, levels = c("Very dissatisfied", "Dissatisfied", "Neither satisfied nor dissatisfied", "Satisfied", "Very Sattisfied")),
spiritually_fed = factor(spiritually_fed, levels = c("Rarely", "Sometimes", "Usually", "Always")),
connected_to_community = factor(connected_to_community, levels = c("Rarely", "Sometimes", "Usually", "Always")),
age_range = factor(age_range, levels = c("Under 20", "20-29", "30-39", "40-49", "50-59", "60-69", "70-79", "80+")),
church_association_length = factor(church_association_length, levels = c("Less than 1 year", "1-5 years", "6-10 years", "11-15 years", "16-20 years", "Over 20 years"))
) |>
select(
-c(response_type, ip_address, progress, finished, starts_with("recipient"), starts_with("location"), distribution_channel, external_data_reference)
)
multi_long <- clean |>
select(
all_of(data_names |> filter(multi_choice == TRUE) |> pull(new_name))
)
multi_long
length(unique(clean$response_id))
nrow(clean)
clean |>
select(
response_id, all_of(data_names |> filter(multi_choice == TRUE) |> pull(new_name))
) |>
pivot_longer(cols = -response_id)
multi_long <- clean |>
select(
response_id, all_of(data_names |> filter(multi_choice == TRUE) |> pull(new_name))
) |>
pivot_longer(cols = -response_id, names_to = "question", values_to = "response") |>
separate_longer_delim(response, ",")
View(multi_long)
View(clean)
unique(multi_long$question)
tabyl(clean$service_attendance)
write_rds(data, "survey_clean.rds")
write_rds(clean, "survey_clean.rds")
write_rds(multi_long, "survey_multi_long.rds")
install.packages("ggfittext")
wide <- read_rds("survey_clean.rds")
long <- read_rds("survey_multi_long.rds")
unique(long$question)
library(readr)
library(dplyr)
library(ggplot2)
install.packages("scales")
library(readr)
library(dplyr)
library(ggplot2)
library(ggfittext)
ggplot(long |> filter(question == "church_expectations_choice"), aes(x = response)) +
geom_bar()
library(forcats)
ggplot(long |> filter(question == "church_expectations_choice"), aes(x = response |> fct_infreq() |> fct_rev())) +
geom_bar() +
theme_minimal()
ggplot(long |> filter(question == "church_expectations_choice"), aes(x = response |> fct_infreq())) +
geom_bar() +
theme_minimal()
ggplot(long |> filter(question == "church_expectations_choice"), aes(x = response |> fct_infreq())) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45)
)
ggplot(long |> filter(question == "church_expectations_choice"), aes(x = response |> fct_infreq())) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1, vjust = 0.5)
)
ggplot(long |> filter(question == "church_expectations_choice"), aes(x = response |> fct_infreq())) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(long |> filter(question == "church_expectations_choice"), aes(x = response |> fct_infreq())) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(long |> filter(question == "connection_factors_choice"), aes(x = response |> fct_infreq())) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(long |> filter(question == "music_styles_choice"), aes(x = response |> fct_infreq())) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(long |> filter(question == "church_priorities_choice"), aes(x = response |> fct_infreq())) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
wide
ggplot(wide, aes(x = church_mission_feeling)) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
names(wide)
ggplot(wide, aes(x = church_mission_feeling)) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(wide, aes(x = service_attendance)) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(wide, aes(x = spiritually_fed)) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
ggplot(wide, aes(x = connected_to_community)) +
geom_bar() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1)
)
